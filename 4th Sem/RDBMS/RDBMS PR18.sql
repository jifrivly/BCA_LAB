RDBMS PROGRAM 19-ACCOUNT DEPOSIT,WITHDRAW


DECLARE
ACNO NUMBER;
AMT NUMBER(8,2);
BAL NUMBER(8,2);
CURSOR C_ACC IS SELECT ACC_NO,BALANCE FROM ACCOUNT; 
BEGIN
OPEN C_ACC;
LOOP
FETCH C_ACC INTO ACNO,BAL;
EXIT WHEN C_ACC%NOTFOUND;
AMT:=BAL-1000;
UPDATE ACCOUNT SET BALANCE=AMT WHERE ACC_NO=ACNO;
SAVEPOINT SP1;
SELECT BALANCE INTO BAL FROM ACCOUNT WHERE ACC_NO=ACNO;
AMT:=BAL+140000;
SAVEPOINT SP2;
UPDATE ACCOUNT SET BALANCE=AMT WHERE ACC_NO=ACNO;
SELECT BALANCE INTO BAL FROM ACCOUNT WHERE ACC_NO=ACNO;
IF BAL>200000 THEN
 ROLLBACK TO SP1;
END IF;
END LOOP;
CLOSE C_ACC;
END;
