RDBMS PROGRAM 15-ELECTRICITY BILL


CREATE TABLE ELEC_BILL(CUST_NO INT PRIMARY KEY,CUST_NAME CHAR(50),UNITS_CONSUMED INT,
BILL_AMT NUMBER(5,2) NULL);

INSERT INTO ELEC_BILL(CUST_NO,CUST_NAME) VALUES(101,'ARUN');

INSERT INTO ELEC_BILL(CUST_NO,CUST_NAME) VALUES(102,'ROHITH');

INSERT INTO ELEC_BILL(CUST_NO,CUST_NAME) VALUES(103,'SAYEED');

INSERT INTO ELEC_BILL(CUST_NO,CUST_NAME) VALUES(104,'SHIBIN');

INSERT INTO ELEC_BILL(CUST_NO,CUST_NAME) VALUES(105,'HAREESH');

CREATE OR REPLACE FUNCTION FINDAMOUNT(CU_NO IN INT,UNITS IN INT)
RETURN NUMBER
IS
 AMT NUMBER(5,2);
BEGIN
  AMT:=UNITS*3.5;
  RETURN AMT;
END;

DECLARE 
 C_NO INT;
 UNTS INT;
 AMOUNT NUMBER(5,2);
BEGIN
  C_NO:=&CUSTOMER_NUMBER;
  UNTS:=&UNITS_CONSUMED;
  AMOUNT:=FINDAMOUNT(C_NO,UNTS);
  UPDATE ELEC_BILL SET UNITS_CONSUMED=UNTS,BILL_AMT=AMOUNT WHERE CUST_NO=C_NO;
  IF SQL%FOUND THEN 
	DBMS_OUTPUT.PUT_LINE('BILL AMOUNT CALCULATED');
  ELSE
	DBMS_OUTPUT.PUT_LINE('CONSUMER NOT FOUND');
END IF;
END;