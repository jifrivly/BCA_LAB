RDBMS PROGRAM 20-BOOK ISSUING,RETURNING,CHECKING


CREATE TABLE BOOK(BOOK_ID INT PRIMARY KEY,B_NAME VARCHAR(25),PUBLISHER VARCHAR(25),
AUTHOR VARCHAR(25),STATUS CHAR);

INSERT INTO BOOK VALUES(1000,'WINGSOFFIRE','MCJ','APJ','T');

INSERT INTO BOOK VALUES(1001,'CPROGRAMMING','TATA','BGS','T');

CREATE TABLE MEMBER(MEM_ID INT PRIMARY KEY,MEM_NAME VARCHAR(25),ADDRESS VARCHAR(25));

INSERT INTO MEMBER VALUES(2000,'SAYEED','CKULAM');

INSERT INTO MEMBER VALUES(2001,'HAREESH','KUNNAMKULAM');

CREATE TABLE ISSUE_BOOK(BOOK_ID INT,MEM_ID INT,ISSUE_DATE DATE);


::::::::::PLSQL BLOCK TO ISSUE BOOKS:::::::::::

CREATE OR REPLACE PROCEDURE ISSUE(BID IN INT,MID IN INT) IS
BEGIN
UPDATE BOOK SET STATUS='F' WHERE BOOK_ID=BID;
IF SQL%FOUND THEN
DBMS_OUTPUT.PUT_LINE('BOOK ISSUED');
INSERT INTO ISSUE_BOOK VALUES(BID,MID,SYSDATE);
ELSE
DBMS_OUTPUT.PUT_LINE('BOOK NOT FOUND');
END IF;
END;

DECLARE
BK_ID INT;
M_ID INT;
BEGIN
BK_ID:=&BOOK_TO_BE_ISSUED;
M_ID:=&MEMBER_ID;
ISSUE(BK_ID,M_ID);
END;

::PLSQL BLOCK TO CHECK AVAILABILITY OF A BOOK:::

CREATE OR REPLACE FUNCTION CHECKAVAIL(BID IN INT)
RETURN CHAR
IS
B_STATUS CHAR;
BEGIN
SELECT STATUS INTO B_STATUS FROM BOOK WHERE BOOK_ID=BID;
RETURN B_STATUS;
END;

DECLARE
BK_ID INT;
BK_STATUS CHAR;
BEGIN
BK_ID:=&BOOK_TO_BE_CHECKED;
BK_STATUS:=CHECKAVAIL(BK_ID);
IF(BK_STATUS='T') THEN
  DBMS_OUTPUT.PUT_LINE('BOOK IS AVAILABLE');
ELSE
  DBMS_OUTPUT.PUT_LINE('BOOK IS NOT AVAILABLE');
END IF;
END;


:::::::PLSQL BLOCK TO RETURN BOOKS::::::::::

CREATE OR REPLACE PROCEDURE RETURNBOOK(BID INT) IS
BEGIN
UPDATE BOOK SET STATUS='T' WHERE BOOK_ID=BID;
IF SQL%FOUND THEN
DBMS_OUTPUT.PUT_LINE('BOOK RETURNED');
ELSE
DBMS_OUTPUT.PUT_LINE('BOOK NOT FOUND');
END IF;
END;

DECLARE
BK_ID INT;
BEGIN
BK_ID:=&BOOK_TO_BE_RETURNED;
RETURNBOOK(BK_ID);
END;




