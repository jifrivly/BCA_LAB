RDBMS PROGRAM 17-AIRLINE SYSTEM


CREATE TABLE PASSANGER(PASSANGERNO INT PRIMARY KEY,PASSANGERNAME CHAR(25),MARITALSTATUS CHAR(15),
AGE INT,SEX CHAR);

CREATE TABLE FLIGHT(FLIGHTNO INT PRIMARY KEY,FLIGHTNAME CHAR(25),CAPACITY INT);

CREATE TABLE PASSANGERFLIGHT(PASSANGERNO INT PRIMARY KEY,FLIGHTNO INT,SEATNO INT);

INSERT INTO PASSANGER VALUES(101,'ARUN','MARRIED',35,'M');

INSERT INTO PASSANGER VALUES(102,'LATHA','MARRIED',43,'F');

INSERT INTO PASSANGER VALUES(103,'SALU','UNMARRIED',23,'M');

INSERT INTO PASSANGER VALUES(104,'REMA','UNMARRIED',23,'F');

INSERT INTO PASSANGER VALUES(105,'AJEESH','MARRIED',38,'M');

INSERT INTO PASSANGER VALUES(106,'LEKHA','MARRIED',37,'F');

INSERT INTO FLIGHT VALUES('AI303','AIRINDIA',125);

INSERT INTO FLIGHT VALUES('SJ100','SINGAPOREJET',100);

INSERT INTO FLIGHT VALUES('JA125','JETAIRWAYS',150);

INSERT INTO PASSANGERFLIGHT VALUES(101,'AI303',35);

INSERT INTO PASSANGERFLIGHT VALUES(102,'JA125',65);

INSERT INTO PASSANGERFLIGHT VALUES(103,'AI303',51);

INSERT INTO PASSANGERFLIGHT VALUES(104,'SJ100',15);

INSERT INTO PASSANGERFLIGHT VALUES(105,'SJ100',48);

INSERT INTO PASSANGERFLIGHT VALUES(106,'JA125',75);

:::::FUNCTION TO COUNT MARRIED FEMALE PASSANGERS:::::::

CREATE OR REPLACE FUNCTION COUNTFEMALE
RETURN INT
IS 
F_PASSANGERS INT;
BEGIN
SELECT COUNT(*) INTO F_PASSANGERS FROM PASSANGER WHERE SEX='F' AND MARITALSTATUS='MARRIED';
RETURN F_PASSANGERS;
END;

DECLARE
F_COUNT INT;
BEGIN
F_COUNT:=COUNTFEMALE();
DBMS_OUTPUT.PUT_LINE('TOTAL NUMBER OF FEMALE PASSANGERS: '||F_COUNT);
END;


::::FUNCTION TO FIND MALE PASSANGERS WHOSE AGE BETWEEN 18 AND 25:::::

CREATE OR REPLACE FUNCTION MALEPASSANGERS(ML_PNO IN INT)
RETURN VARCHAR2
IS 
Ml_PNAME VARCHAR(25);
BEGIN
SELECT PASSANGERNAME INTO Ml_PNAME FROM PASSANGER WHERE PASSANGERNO=ML_PNO;
RETURN Ml_PNAME;
END;

DECLARE
CURSOR C_MALES IS SELECT PASSANGERNO FROM PASSANGER WHERE AGE BETWEEN 18 AND 25 AND SEX='M';
M_PNO INT;
M_PNAME VARCHAR(25);
BEGIN
DBMS_OUTPUT.PUT_LINE('MALE PASSANGERS IN BETWEEN AGE 18 AND 25');
OPEN C_MALES;
LOOP 
FETCH C_MALES INTO M_PNO;
EXIT WHEN C_MALES%NOTFOUND;
M_PNAME:=MALEPASSANGERS(M_PNO);
DBMS_OUTPUT.PUT_LINE(M_PNAME);
END LOOP;
CLOSE C_MALES;
END;






