RDBMS PROGRAM 14-EMPLOYEE SALARY

CREATE TABLE EMP_SALARY(EMP_NO INT PRIMARY KEY,NAME CHAR(20),BASIC_PAY NUMBER(10,2));

INSERT INTO EMP_SALARY VALUES(1001,'RAJU',9000);
INSERT INTO EMP_SALARY VALUES(1002,'RAMU',38000);
INSERT INTO EMP_SALARY VALUES(1003,'AJU',18000);
INSERT INTO EMP_SALARY VALUES(1004,'ABHI',41000);
INSERT INTO EMP_SALARY VALUES(1005,'ROHIT',36000);
INSERT INTO EMP_SALARY VALUES(1006,'SURESH',16000);
INSERT INTO EMP_SALARY VALUES(1007,'PRAVEEN',34000);
INSERT INTO EMP_SALARY VALUES(1008,'ROKESH',45000);
INSERT INTO EMP_SALARY VALUES(1009,'VIKRAM',8000);
INSERT INTO EMP_SALARY VALUES(1010,'KUMAR',24000);

ALTER TABLE EMP_SALARY ADD(DA NUMBER(10,2),GROSSSALARY NUMBER(10,2),
PF NUMBER(10,2),NETSALARY NUMBER(10,2),ANNUALSALARY NUMBER(10,2),TAX NUMBER(10,2));

DECLARE
    DA1 NUMBER(10,2);
    GR_SAL NUMBER(10,2);
    PF1 NUMBER(10,2);
    N_SAL NUMBER(10,2);
    AN_SAL NUMBER(10,2);
    TAX1 NUMBER(10,2);
    
    CURSOR C_EMP IS SELECT EMP_NO,NAME,BASIC_PAY FROM EMP_SALARY;
    EMP_REC C_EMP%ROWTYPE;
BEGIN
    OPEN C_EMP;
    LOOP
        FETCH C_EMP INTO EMP_REC;
        EXIT WHEN C_EMP%NOTFOUND;
        DA1:=EMP_REC.BASIC_PAY*40/100;
        PF1:=EMP_REC.BASIC_PAY*10/100;
        GR_SAL:=EMP_REC.BASIC_PAY+DA1;
        N_SAL:=GR_SAL-PF1;
        AN_SAL:=12*N_SAL;
        
        IF AN_SAL<100000 THEN
            TAX1:=0;
        ELSIF AN_SAL>=100000 AND AN_SAL<150000 THEN
            TAX1:=(AN_SAL-100000)*10/100;
        ELSIF AN_SAL>=150000 AND AN_SAL<250000 THEN
            TAX1:=(AN_SAL-150000)*20/100;
        ELSIF AN_SAL>250000 THEN
            TAX1:=(AN_SAL-250000)*30/100;
        END IF;
            UPDATE EMP_SALARY SET DA=DA1,GROSSSALARY=GR_SAL,PF=PF1,NETSALARY=N_SAL,ANNUALSALARY=AN_SAL,TAX=TAX1 WHERE EMP_NO=EMP_REC.EMP_NO;
    END LOOP;
END;

SELECT * FROM EMP_SALARY;